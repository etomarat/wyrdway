# BACKLOG и Definition of Done (DoD) для M1–M4

## 1. Что такое DoD
**DoD (Definition of Done)** — это набор проверяемых критериев, по которым мы честно говорим: «этап завершён».

Зачем:
- не расползаться по скоупу;
- быстрее принимать решения;
- понимать, что тестировать;
- фиксировать минимум качества.

Правило: если пункт DoD не выполнен — этап считается незакрытым, даже если «почти готово».

---

## 2. Глобальные правила для всех этапов
1) **Данные ≠ логика**: контент и тюнинг — через таблицы/конфиги; в коде минимум хардкода.
2) **Сцены изолированы**: сцена владеет своим UI/логикой и общается через RunState/MetaState.
3) **Сохранения только в гараже**: прогресс рана не сохраняется.
4) **Минимум фич, максимум петли**: сначала замкнутая петля, потом украшательства.
5) **Расширяемость важнее полноты**: лучше один рабочий тип, но с правильными интерфейсами.

---

## 3. Бэклог: приоритеты
Формат приоритета:
- **P0 (must)** — без этого этап не считается выполненным.
- **P1 (should)** — желательно, если не ломает сроки.
- **P2 (nice)** — в запас, после закрытия DoD.

---

## 4. M1 — Вертикальный срез петли (минимальный, но расширяемый)
### Цель
Сделать один рабочий игровой цикл: **GARAGE → REGION_MAP → DRIVE → POI → RESULT → GARAGE**.

### DoD M1
**Петля:**
- Можно начать ран в гараже.
- Можно выбрать следующий узел/точку на карте региона.
- Езда работает (управление + базовые ресурсы машины).
- Есть один POI-прототип (минимальная интеракция + таймер/давление).
- Можно завершить сегмент/вылазку и попасть на RESULT.
- RESULT применяет итоги к профилю и возвращает в гараж.

**Стабильность:**
- 10 последовательных прохождений петли без краша.
- Нет «двойного применения» наград/штрафов.
- Любые критические ошибки не разрушают профиль (гарантия сохранений только в гараже).

**Расширяемость:**
- RunState/MetaState используются как контракт; сцены не лезут в чужие данные напрямую.
- TUNING влияет на ощущения (скорости/расходы/таймеры) без правок логики.
- Подготовлен минимальный каркас контентных таблиц (можно держать мок-данные, но структура подразумевается).

### M1 — P0 (must)
- Скелет сцен и SceneManager.
- RunState минимально жизнеспособный.
- GARAGE: старт рана + 1–2 действия (например, «починить»/«поставить апгрейд» заглушкой).
- REGION_MAP: выбор следующего узла (хоть списком).
- DRIVE: управление + базовые ресурсы (HP/топливо/температура или их подмножество).
- POI: один тип поведения (таймер + 1–2 действия: «взять лут», «уйти»).
- RESULT: расчёт дельт (лут/урон/стоимость ремонта) и применение к профилю.
- SAVE/LOAD: сохраняем только профиль в гараже.
- Debug overlay/лог: сцена, ключевые статы, seed.

### M1 — P1 (should)
- Простейшая генерация узлов маршрута (не ручной список).
- Один тип угрозы/аномалии на дороге или в POI.
- Мини-UI читаемости (индикаторы топлива/HP/таймера).

### M1 — P2 (nice)
- Анимации/эффекты/звук.
- Несколько POI.
- Инвентарь с сеткой (в M1 достаточно списка/стэков).

### Явные «не делаем» в M1
- Continue/загрузка рана.
- Полная система контента с валидацией и редакторами.
- Большой набор врагов/аномалий.
- Глубокая экономика/магазин.

---

## 5. M2 — Данные и контент (таблицы, валидация, вариативность)
### Цель
Сделать игру **контент-управляемой**: добавление POI/лут/угрозы через таблицы без переписывания систем.

### DoD M2
- Контентные таблицы реально используются в рантайме.
- Есть проверка ссылок (id/ref) и базовая валидация.
- Есть минимум по контенту:
  - несколько POI (2–4),
  - несколько источников угроз (2–4),
  - лут-таблицы с редкостями,
  - 3–6 апгрейдов.
- Баланс настраивается через TUNING + данные.
- Генерация региона/маршрута использует таблицы и seed.

### M2 — P0 (must)
- Подключить реальные таблицы POI/LOOT/UPGRADES/THREATS.
- Валидация: обязательные поля, типы, диапазоны, ссылки.
- Выбор POI/лут по таблицам.
- 1–2 апгрейда реально меняют параметры машины/возможности.

### M2 — P1 (should)
- Система «уровень угрозы» реально влияет на спавн/множители.
- Небольшая вариативность POI (варианты комнат/пулы событий).

### M2 — P2 (nice)
- Инструменты для ускорения контент-итераций (простые хелперы/генераторы).

---

## 6. M3 — Играбельность, полировка, баланс
### Цель
Сделать M2-версию **играбельной**: темп, читаемость, фидбек, базовый баланс.

### DoD M3
- Есть ощущаемый прогресс: апгрейды дают понятную пользу.
- Езда и рейды имеют понятные риски/награды.
- Баланс проходит базовые тесты:
  - «слишком легко» и «слишком больно» устранены до приемлемого уровня.
- UI сообщает критические состояния (низкое топливо, перегрев, таймер).
- Минимальный набор звуков/эффектов для читаемости.

### M3 — P0 (must)
- Баланс TUNING по основным ручкам.
- Полировка UI/индикаторов.
- Подстройка темпа сегментов и времени POI.

### M3 — P1 (should)
- 1–2 дополнительных режима сложности (наборы параметров).
- Мини-обучение/подсказки в UI.

### M3 — P2 (nice)
- Пост-ран статистика.

---

## 7. M4 — Расширение контента и долговременная вариативность
### Цель
Сделать игру «долгоиграющей»: больше вариантов, связки, события, редкие находки.

### DoD M4
- Достаточная вариативность POI/угроз/лут-пулов, чтобы 10–20 ран подряд не были одинаковыми.
- Появляются редкие элементы (редкие апгрейды/аномалии/POI).
- Система угроз раскрывается: разные классы угроз имеют разные контр-стратегии.

---

## 8. Что нужно сделать сейчас (финал препрода)
Чтобы закрыть препрод полностью перед стартом M1, достаточно:
1) Этот документ (DoD и приоритеты) — **готов**.
2) Зафиксировать **конкретный список P0 задач M1** как «первую очередь» (ниже).

### Список задач M1 (P0) — первая очередь
1) Скелет сцен + переходы.
2) RunState минимальный.
3) GARAGE: старт рана, отображение статов.
4) REGION_MAP: выбор узла.
5) DRIVE: управление + расход ресурса.
6) POI: таймер + действие «взять/уйти».
7) RESULT: дельты + применение к профилю.
8) SAVE/LOAD профиля только в гараже.
9) Debug overlay.

### Вторая очередь M1 (P1)
- 1 угроза на дороге или в POI.
- Мини-генерация узлов.

---

## 9. Контроль «скоуп не расползается»
Перед добавлением любой новой фичи в M1 задаём 3 вопроса:
1) Это нужно, чтобы замкнуть петлю?
2) Это повышает проверяемость/стабильность?
3) Это не блокирует расширяемость позже?

Если ответ «нет» хотя бы на 2 пункта — переносим в M2+.

